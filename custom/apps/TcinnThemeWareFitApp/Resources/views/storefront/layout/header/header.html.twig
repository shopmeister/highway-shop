{% sw_extends '@Storefront/storefront/layout/header/header.html.twig' %}

{# @TODO: prüfen... #}

{# ---------------- START: SET TEMPLATE VARS ---------------- #}

{# ThemeWare: Set theme variables #}
{% set twtHeaderSearchShow = theme_config('twt-header-search-show') %}
{% set twtHeaderSearchType = theme_config('twt-header-search-type') %}
{% set twtHeaderTopBarShow = theme_config('twt-header-top-bar-show') %}
{% set twtHeaderType = theme_config('twt-header-type') %}
{% set twtHeaderPhoneType = theme_config('twt-header-phone-type') %}
{% set twtHeaderPhoneCartBtnHighlighting = theme_config('twt-header-phone-cart-btn-highlighting') %}
{% set twtHeaderPhoneBtnHome = theme_config('twt-header-phone-btn-home') %}
{% set twtIconSet = theme_config('twt-iconset') %}
{% set twtNavMainShow = theme_config('twt-nav-main-show') %}

{% set twtHeaderTypeCompatibility = theme_config('twt-header-type-compatibility') %}

{% set twtNavMainShow = theme_config('twt-nav-main-show') %}
{% set twtUspBarHeaderLayout = theme_config('twt-usp-bar-header-layout') %}

{# ---------------- END: SET TEMPLATE VARS ---------------- #}

{# @TODO: Add 'twtHeaderTypeCompatibility'-if to disable all header-adjustments #}

{# ThemeWare: Adjustments to the 'Top bar' #}
{# INFO: Remove 'Top bar' if it has been disabled via the theme configuration #}
{# @TODO: HC-Architecture... #}
{% block layout_top_bar %}
	{% if twtHeaderTopBarShow == 1 %}
		{# ThemeWare: Clear block -> Remove 'Top bar' #}

	{% else %}
		{# Default block #}
		{{ parent() }}

	{% endif %}
{% endblock %}


{# ThemeWare: Adjustments to the 'Search input' #}
{# INFO: Such-Input entfernen falls...
	- "Header 2.1" (twt-header-type 4) aktiv ist. (Info: Header 2.1 unterstützt derzeit lediglich die "Flyout-" bzw. "Fullscreen-Suche")
	- die "Flyout-Suche" in der Theme-Konfiguration aktiviert wurde.
	- die "Fullscreen-Suche" in der Theme-Konfiguration aktiviert wurde.
#}
{# @TODO: HC-Architecture... #}
{% block layout_header_search %}
	{% if twtHeaderSearchType == 2 or twtHeaderSearchType == 4 or twtHeaderType == 4 %}
		{# ThemeWare: Clear block -> Remove 'Search input' #}

	{% else %}
		{# Default block #}
		{{ parent() }}

	{% endif %}
{% endblock %}


{# ThemeWare: Adjustments of the toggle button of the 'Top navigation' #}
{# @TODO: HC-Architecture... #}
{% block layout_header_navigation_toggle %}

	{# ThemeWare: Add 'Home button'to phone header #}
	{% if twtHeaderPhoneType == 2 and twtHeaderPhoneBtnHome == 2 %}
		{# INFO: Only with 'Sales Promoting Navigation' and active home button #}
		{% block twt_layout_header_home_button %}
			<div class="col-auto twt-home-col d-sm-none">
				<a href="{{ path('frontend.home.page') }}"
				   class="btn header-home-btn header-actions-btn{% if controllerAction is same as('home') %} active{% endif %} home-link"
				   title="{{ 'general.homeLink'|trans|striptags }}"
				   aria-label="{{ 'general.homeLink'|trans|striptags }}"
				   itemprop="url"
				>
					<span class="header-home-icon">
						<span itemprop="name">
                            {% block twt_layout_header_home_button_icon %}
								{# @TODO tag:v6.7.0 - Check if ariaHidden is needed #}
                                {% sw_icon 'home' %}
                            {% endblock %}
						</span>
					</span>
				</a>
			</div>
		{% endblock %}
	{% endif %}

	{# ThemeWare: Modify classes to show/hide toggle button ---------------------- #}

	{# ThemeWare: Add classes for thr 'Sales Promoting Navigation' #}
	{% if twtHeaderPhoneType == 2 %}
		{% set blockClassesMenuButton = ['col-auto col-sm twt-navigation-col'] %}
	{% else %}
		{% set blockClassesMenuButton = ['col'] %}
	{% endif %}
	
	{# ThemeWare: 'Top navigation' => hidden #}
	{# INFO: "Top-Navigation" nur mobil anzeigen wenn Sie über die Theme-Konfiguration deaktiviert wurde #}
	{% if twtNavMainShow == 1 %}
		{% set blockClassesMenuButton = ['d-block d-lg-none']|merge(blockClassesMenuButton) %}
	{% endif %}

	{# ThemeWare: 'Top navigation' => list #}
	{# INFO: Anpassungen falls die "Top-Navigation" als "Liste" dargestellt wird #}
	{% if twtNavMainShow == 2 %}
		{% if twtHeaderType == 4 %}
			{# ThemeWare: Add classes for 'Header 2.1' #}
			{% set blockClassesMenuButton = ['d-block d-lg-none']|merge(blockClassesMenuButton) %}

		{% elseif twtHeaderType == 10 %}
			{# ThemeWare: Add classes for 'Header 10' #customHeader #}
			{% set blockClassesMenuButton = ['d-none twt-sticky-header-menu-button']|merge(blockClassesMenuButton) %}

		{% else %}
			{# ThemeWare: Add classes for all other headers #}
			{% if twtHeaderSearchType == 2 or twtHeaderSearchType == 4 %}
				{# INFO: 'Flyout search' (twt-header-search-type 2) or 'Fullscreen search' (twt-header-search-type 4) active #}
				{% set blockClassesMenuButton = ['d-block d-lg-none']|merge(blockClassesMenuButton) %}
			{% else %}
				{% set blockClassesMenuButton = ['d-block d-sm-none']|merge(blockClassesMenuButton) %}
			{% endif %}

		{% endif %}
	{% endif %}

	{# ThemeWare: 'Top navigation' => button #}
	{# INFO: Anpassungen falls die "Top-Navigation" als "Button" (default) dargestellt wird... #}
	{% if twtNavMainShow == 3 %}
		{# ThemeWare: Add classes for the 'Flyout search' or the 'Fullscreen search' #}
		{% if twtHeaderSearchType == 2 or twtHeaderSearchType == 4 %}
			{% set blockClassesMenuButton = ['d-block']|merge(blockClassesMenuButton) %}

		{% else %}
			{# ThemeWare: Add classes for 'Header 2.1' #}
			{% if twtHeaderType == 4 %}
				{% set blockClassesMenuButton = ['d-sm-block']|merge(blockClassesMenuButton) %}
			{% else %}
				{% set blockClassesMenuButton = ['d-sm-none d-lg-block']|merge(blockClassesMenuButton) %}
			{% endif %}

		{% endif %}
	{% endif %}

	{# ThemeWare: Adjustments to the toggle button of the 'Top navigation' #}
	{# INFO: Klassen (siehe oben) hinzufügen und Label "Navigation" ergänzen #}
	<div class="{{ blockClassesMenuButton|join(' ') }}">
		<div class="menu-button">

			{% block layout_header_navigation_toggle_button %}
				<button
                    class="btn nav-main-toggle-btn header-actions-btn"
					type="button"
					data-off-canvas-menu="true"
					aria-label="{{ 'general.menuLink'|trans|striptags }}"
					title="{{ 'twt.header.offcanvasMenuText'|trans }}"
				>
					{% block layout_header_navigation_toggle_button_icon %}
						{# ThemeWare: Replace icon #}
						{# @TODO tag:v6.7.0 - Check if ariaHidden is needed #}
						{% if twtIconSet is not same as ('default') %}
							{% sw_icon 'stack' style { pack: 'themeware' } %}
						{% else %}
							{% sw_icon 'stack' %}
						{% endif %}
					{% endblock %}

					{# ThemeWare: Add label 'Navigation' to the toggle button #}
					<span class="header-nav-main-toggle-label">
						{{ 'twt.header.offcanvasMenuText'|trans }}
					</span>
				</button>
			{% endblock %}

		</div>
	</div>
{% endblock %}


{# ThemeWare: Adjustments to the toggle button of the 'Top navigation'. @tablet #}
{#
{% block layout_header_navigation_toggle_tablet %}{% endblock %}
#}


{# ThemeWare: Adjustments to the icon of the 'Top navigation' toggle button @tablet #}
{# @TODO: Default-Konfiguration ergänzen #}
{# @TODO: Mit toggle button (siehe oben) abgleichen #}

{# @TODO: HC-Architecture... #}
{% block layout_header_navigation_toggle_tablet_button_icon %}
	{# ThemeWare: Replace icon #}
	{% if twtIconSet is not same as ('default') %}
		{% sw_icon 'stack' style { pack: 'themeware' } %}
	{% else %}
		{% sw_icon 'stack' %}
	{% endif %}

	{# ThemeWare: Add label 'Navigation' to the toggle button #}
	<span class="header-nav-main-toggle-label">
		{{ 'twt.header.offcanvasMenuText'|trans }}
	</span>
{% endblock %}


{# ThemeWare: Anpassungen am Toggle-Button der Suche
	- $twt-header-search-show: 1 don't, 2 show > d-none
	- $twt-header-search-type: 1 input, 2 flyout > d-sm-none
#}
{# @TODO: Default-Konfiguration ergänzen #}
{# @TODO: "Header 2.1" (twt-header-type 4) ggf. berücksichtigen ?! #}

{# @TODO: HC-Architecture... #}
{% block layout_header_search_toggle %}
	{# ThemeWare: Modify classes to show/hide the toggle button #}
	{% set blockClassesSearchToggle = ['col-auto twt-search-col'] %}

	{# ThemeWare: 'Search' => hidden #}
	{% if twtHeaderSearchShow == 1 %}
		{% set blockClassesSearchToggle = ['d-none']|merge(blockClassesSearchToggle) %}
	{% endif %}

	{# ThemeWare: Add classes if the 'Flyout search' (twt-header-search-type 2) or the 'Fullscreen search' (twt-header-search-type 4) are not active #}
	{% if twtHeaderSearchType != 2 and twtHeaderSearchType != 4 %}
		{% set blockClassesSearchToggle = ['d-sm-none']|merge(blockClassesSearchToggle) %}
	{% endif %}

	{# ThemeWare: Hide toggle button in 'Header 2.1' (twt-header-type 4) or if 'Flyout search' or 'Fullscreen search' are active #}
	{% if twtHeaderSearchType != 2 and twtHeaderSearchType != 4 %}
		{% if twtHeaderType == 4 %}
			{% set blockClassesSearchToggle = ['d-none'] %}
		{% endif %}
	{% endif %}

	<div class="{{ blockClassesSearchToggle|join(' ') }}">
		  <div class="search-toggle">
				<button class="btn header-actions-btn search-toggle-btn js-search-toggle-btn collapsed"
						type="button"
						data-bs-toggle="collapse"
						data-bs-target="#searchCollapse"
						aria-expanded="false"
						aria-controls="searchCollapse"
						aria-label="{{ 'header.searchButton'|trans|striptags }}"
				>
					{# ThemeWare: Add wrapper around icon and 'x' icon #}
					<span class="header-search-toggle-icon">
                    	{# @TODO tag:v6.7.0 - Check if ariaHidden is needed #}
						{% if twtIconSet is not same as ('default') %}
							{% sw_icon 'search' style { pack: 'themeware' } %}
						{% else %}
							{% sw_icon 'search' %}
						{% endif %}

						{% if twtIconSet is not same as ('default') %}
							{% sw_icon 'x' style { pack: 'themeware' } %}
						{% else %}
							{% sw_icon 'x' %}
						{% endif %}
					</span>

					{# ThemeWare: Add label to toggle button #}
					<span class="header-search-toggle-name">
						{{ 'twt.header.searchText'|trans }}
					</span>
				</button>
		  </div>
	 </div>
{% endblock %}


{# ThemeWare: 'Header 10' (twt-header-type 10) #customHeader #}
{# INFO: Aufbau für den "Custom-Header" modifizieren #}
{# @TODO: HC-Architecture... #}
{% block layout_header_navigation %}
	{% if twtHeaderType == 10 %}
		<div class="nav-header {{ navHeaderClasses|join(' ') }}">
			<div class="container">
				<div class="row align-items-center header-row {{ headerRowClasses }}">

					{{ block('layout_header_logo') }}

					{% block twt_layout_header_main_navigation %}
						<div class="header-nav-col nav-main d-none col-lg">
							{% block twt_layout_header_main_navigation_inner %}
								{% sw_include '@Storefront/storefront/layout/navigation/navigation.html.twig' %}
							{% endblock %}
						</div>
					{% endblock %}

					{{ block('layout_header_search') }}

					{{ block('layout_header_actions') }}

				</div>
			</div>
		</div>

	{% else %}
		{# Default block #}
		{{ parent() }}

	{% endif %}
{% endblock %}


{# ThemeWare: Add classes for the 'Cart button' in 'Sales Promoting Navigation' #}
{% block layout_header_actions_cart %}
	{# if twtHeaderPhoneType == 2 and twtHeaderPhoneCartBtnHighlighting == 2 #}
	{% if twtHeaderPhoneType == 2 %}
		<div class="col-auto twt-cart-col">
			<div
				class="header-cart"
				data-off-canvas-cart="true"
			>
				<a href="{{ path('frontend.checkout.cart.page') }}"
				   class="btn header-cart-btn header-actions-btn"
				   title="{{ 'checkout.cartTitle'|trans|striptags }}"
				   aria-label="{{ 'checkout.cartTitle'|trans|striptags }}"
				   data-cart-widget="true"
				>
					{% sw_include '@Storefront/storefront/layout/header/actions/cart-widget.html.twig' %}
				</a>
			</div>
		</div>

	{% else %}
		{# Default block #}
		{{ parent() }}

	{% endif %}
{% endblock %}


{# ThemeWare: Add classes for the 'Wishlist button' in 'Sales Promoting Navigation' #}
{% block layout_header_actions_wishlist %}
	{# if twtHeaderPhoneType == 2 and twtHeaderPhoneCartBtnHighlighting == 2 #}
	{% if twtHeaderPhoneType == 2 %}
		<div class="col-auto twt-wishlist-col">
			<div class="header-wishlist">
				<a href="{{ path('frontend.wishlist.page') }}"
				   class="btn header-wishlist-btn header-actions-btn"
				   title="{{ 'header.wishlist'|trans|striptags }}"
				   aria-label="{{ 'header.wishlist'|trans|striptags }}"
				>
					{% sw_include '@Storefront/storefront/layout/header/actions/wishlist-widget.html.twig' %}
				</a>
			</div>
		</div>

	{% else %}
		{# Default block #}
		{{ parent() }}

	{% endif %}
{% endblock %}


{# ThemeWare: Add classes for the 'Account button' in 'Sales Promoting Navigation' #}
{% block layout_header_actions_account %}
	{# if twtHeaderPhoneType == 2 and twtHeaderPhoneCartBtnHighlighting == 2 #}
	{% if twtHeaderPhoneType == 2 %}
		<div class="col-auto twt-account-col">
			<div class="account-menu">
				{% sw_include '@Storefront/storefront/layout/header/actions/account-widget.html.twig' %}
			</div>
		</div>

	{% else %}
		{# Default block #}
		{{ parent() }}

	{% endif %}
{% endblock %}