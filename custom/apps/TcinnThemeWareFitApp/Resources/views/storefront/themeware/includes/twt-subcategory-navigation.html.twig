{# ThemeWare® 'Subcategory navigation' conent #}
{#
    @Storefront/storefront/themeware/includes/twt-subcategory-navigation.html.twig
#}

{# INFO: Based on 'layout/sidebar/category-navigation.html.twig'.
   - @deprecated tag:v6.7.0 - This template will be removed, use src/Storefront/Resources/views/storefront/layout/navbar/categories.html.twig
#}

{# @TODO: Blöcke prüfen... #}
{# @TODO: twt prefix... #}

{% block layout_navigation_categories %}
    {#% set navigationMaxDepth = 3 %#}
    {% set navigationMaxDepth = context.salesChannel.navigationCategoryDepth %}

    {% if not level %}
        {% set level = 0 %}
    {% endif %}

    {% block layout_navigation_categories_list %}
        <ul class="category-navigation level-{{ level }}">
            {% for treeItem in navigationTree %}
                {% block layout_navigation_categories_list_entry %}
                    {% if (treeItem.category.id in activeResult.id) or (treeItem.category.id in activeResult.path) %}
                        <li class="category-navigation-entry">
                            {% if treeItem.category.type == 'folder' %}
                                {% block layout_navigation_categories_folder_children %}
                                    <span class="category-navigation-link">{{ treeItem.category.translated.name }}</span>
                                {% endblock %}

                            {% else %}
                                {% block layout_navigation_categories_link_children %}
                                    <a href="{{ category_url(treeItem.category) }}"
                                       class="category-navigation-link{% if treeItem.category.id is same as(activeResult.id) %} is-active{% endif %}{% if treeItem.category.id in activeResult.path %} in-path{% endif %}"
                                       {# @TODO tag:v6.7.0 - Check if aria-label is needed #}
                                       {% if category_linknewtab(treeItem.category) %}target="_blank"{% endif %}
                                    >
                                        {% block layout_navigation_categories_link_children_name %}
                                            {{ treeItem.category.translated.name }}
                                        {% endblock %}

                                    </a>
                                {% endblock %}

                            {% endif %}

                            {% block layout_navigation_categories_recoursion %}
                                {% if level < navigationMaxDepth %}
                                    {% sw_include '@Storefront/storefront/layout/sidebar/category-navigation.html.twig' with {
                                        navigationTree: treeItem.children,
                                        activeResult: activeResult,
                                        page: page,
                                        level: level + 1
                                    } only %}
                                {% endif %}
                            {% endblock %}
                        </li>
                    {% endif %}
                {% endblock %}
            {% endfor %}
        </ul>
    {% endblock %}

{% endblock %}