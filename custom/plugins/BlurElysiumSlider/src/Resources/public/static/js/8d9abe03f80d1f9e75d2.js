(window["webpackJsonpPluginblur-elysium-slider"]=window["webpackJsonpPluginblur-elysium-slider"]||[]).push([[3234],{7583:function(){},3234:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return a}});let{Utils:o}=Shopware;function s(e){return o.object.deepMergeObject(structuredClone(i),e)}let i={colStart:null,colEnd:12,rowStart:null,rowEnd:null,order:null},c={viewports:{mobile:s(),tablet:s({colEnd:6}),desktop:s({colEnd:6})}};l(907);let{Component:r,Store:n,Mixin:d}=Shopware;var a=r.wrapComponentConfig({template:'<div class="blur-elysium-cms-section-wrapper"\n    @dragover.prevent\n    ref="elysiumSectionWrapper"\n    v-droppable="{ dragGroup: \'cms-stage\' }">\n\n    <blur-elysium-cms-section-add-block \n        v-if="section.blocks.length === 0"\n        :key="0"\n        @click="onAddBlock"\n        v-droppable="{ dragGroup: \'cms-stage\', data: getDropData(0), onDrop: block => dropBlock(block, 0) }" />\n\n    <div \n        class="blur-elysium-section-grid"\n        :style="gridStyle"\n        v-if="section.blocks.length > 0"\n        ref="elysiumSectionGrid"\n        @dragover.prevent \n        @drop="onGridDrop">\n\n        <template\n            v-for="(block, index) in section.blocks"\n            :key="block.id">\n            \n            <sw-cms-block\n                ref="elysiumStageBlock"\n                :class="[\'sw-cms-stage-block\', \'blur-elysium-section-block\']"\n                :block="block"\n                :disabled="disabled"\n                :active="cmsPage.selectedBlock !== null && cmsPage.selectedBlock.id === block.id"\n                :has-errors="hasBlockErrors(block)"\n                :style="setBlockStyles(block)"\n                v-droppable="{ dragGroup: \'cms-stage\', data: getDropData(index + 1), onDrop: block => dropBlock(block, index + 1) }"\n                @block-overlay-click="onBlockSelection(block)">\n            \n                <div class="blur-elysium-section-block-dropper">\n                    <mt-icon name="regular-plus-circle" />\n                    Zum anf\xfcgen hier platzieren\n                </div>\n\n                <div class="blur-elysium-section-block-resizer" \n                    draggable="true" \n                    @click="test"\n                    @dragstart="$event => startBlockResizeX($event, block, index)"\n                    @dragend="endBlockResizeX"\n                    @drag="dragBlockResizingX" />\n\n                <component\n                    :is="`sw-cms-block-${block.type}`"\n                    :block="block">\n\n                    \n                    <template\n                        v-for="el in block.slots"\n                        :key="el.id"\n                        #[el.slot]\n                    >\n                        <sw-cms-slot\n                            :element="el"\n                            :active="cmsPage.selectedBlock !== null && cmsPage.selectedBlock.id === block.id"\n                        />\n                    </template>\n\n                </component>\n\n            </sw-cms-block>\n\n        </template>\n\n    </div>\n</div>',props:["section"],inject:["cmsService"],mixins:[d.getByName("cms-state"),d.getByName("blur-device-utilities")],data(){return{draggedBlock:null,draggedBlockStartPosX:0,draggedBlockWidth:0}},watch:{"section.blocks.length":{handler(){this.section.blocks.map(e=>{null===e.customFields?e.customFields={elysiumBlockSettings:structuredClone(c)}:e.customFields.hasOwnProperty("elysiumBlockSettings")||(e.customFields.elysiumBlockSettings=structuredClone(c))})}}},computed:{cmsPage(){return n.get("cmsPage")},device(){return"tablet-landscape"===this.cmsPage.currentCmsDeviceView?"tablet":this.cmsPage.currentCmsDeviceView},gridStyle(){return{display:"grid",gridTemplateColumns:"repeat(12, minmax(0, 1fr))",gap:`${this.viewportsPlaceholder("gridGap",20)}px`,paddingBlock:`${this.viewportsPlaceholder("paddingY",0)}px`,paddingInline:`${this.viewportsPlaceholder("paddingY",0)}px`,alignItems:this.viewportsPlaceholder("alignItems","stretch")}}},methods:{getDropData(e,t="main"){return{dropIndex:e,section:this.section,sectionPosition:t}},dropBlock(e,t){this.section.blocks[t].hasOwnProperty("customFields")?this.section.blocks[t].customFields.elysiumBlockSettings=structuredClone(c):this.section.blocks[t].customFields={elysiumBlockSettings:structuredClone(c)}},setBlockStyles(e){let t={},l=e.customFields?.elysiumBlockSettings?.viewports;return l&&(t["--blur-elysium-section-block-col-start"]=this.viewportsPlaceholder("colStart","auto",null,l),t["--blur-elysium-section-block-col-end"]=this.viewportsPlaceholder("colEnd",12,null,l),t["--blur-elysium-section-block-row-start"]=this.viewportsPlaceholder("rowStart","auto",null,l),t["--blur-elysium-section-block-row-end"]=this.viewportsPlaceholder("rowEnd","auto",null,l),t["--blur-elysium-section-block-order"]=this.viewportsPlaceholder("order",999,null,l)),t},hasBlockErrors(e){return[this.hasUniqueBlockErrors(e),this.hasSlotConfigErrors(e)].some(e=>!!e)},hasUniqueBlockErrors(e){let t=this.pageSlotsError?.parameters?.elements;return!!t&&t.some(t=>t.blockIds.includes(e.id))},hasSlotConfigErrors(e){let t=this.pageSlotConfigError?.parameters?.elements;return!!t&&t.some(t=>t.blockId===e.id)},onBlockSelection(e){this.cmsPage.setBlock(e),this.$emit("on-select-block",e)},onGridDrop(e){this.draggedBlock.customFields.elysiumBlockSettings.viewports[this.device].colEnd=this.calculateDraggedBlockColWidth(e.x)},startBlockResizeX(e,t){this.draggedBlock=t,this.draggedBlockStartPosX=e.x,this.draggedBlockWidth=e.target.offsetParent.offsetWidth;let l=new Image;l.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",e.dataTransfer.setDragImage(l,0,0)},dragBlockResizingX(e){this.calculateDraggedBlockColWidth(e.x)>0&&12>=this.calculateDraggedBlockColWidth(e.x)&&(this.draggedBlock.customFields.elysiumBlockSettings.viewports[this.device].colEnd=this.calculateDraggedBlockColWidth(e.x))},endBlockResizeX(e){this.calculateDraggedBlockColWidth(e.x)>=12&&(this.draggedBlock.customFields.elysiumBlockSettings.viewports[this.device].colEnd=12)},calculateDraggedBlockColWidth(e){let t=this.draggedBlockWidth;return Math.round((t+(e-this.draggedBlockStartPosX))/((this.$refs.elysiumSectionGrid.offsetWidth-2*parseFloat(window.getComputedStyle(this.$refs.elysiumSectionGrid).getPropertyValue("padding-inline")))/12))},onAddBlock(){this.$emit("on-add-block")}},created(){this.viewportsSettings=this.section.customFields?.elysiumSectionSettings?.viewports}})},907:function(e,t,l){var o=l(7583);o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals),l(5346).Z("7c4c6b67",o,!0,{})}}]);